<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MoTech Cloud | Ø±Ø§ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø°ÙƒÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Ø£Ù„ÙˆØ§Ù† Ù…Ø³ØªÙˆØ­Ø§Ø© Ù…Ù† ØµÙˆØ±Ø© MoTech */
            --primary: #00d4ff;        /* Ø£Ø²Ø±Ù‚ Ø³Ù…Ø§ÙˆÙŠ */
            --secondary: #a855f7;      /* Ø¨Ù†ÙØ³Ø¬ÙŠ */
            --accent: #06b6d4;         /* Ø³Ù…Ø§ÙˆÙŠ */
            --dark: #0f172a;           /* Ø¯Ø§ÙƒÙ† */
            --darker: #020617;         /* Ø£ØºÙ…Ù‚ */
            --glass: rgba(15, 23, 42, 0.85);
            --glass-light: rgba(255, 255, 255, 0.05);
            --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            --glow: 0 0 30px rgba(0, 212, 255, 0.3);
        }

        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: var(--darker);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #fff;
            position: relative;
            overflow-x: hidden;
        }

        /* Ø®Ù„ÙÙŠØ© MoTech Ø§Ù„Ø¶Ø¨Ø§Ø¨ÙŠØ© */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://files.manuscdn.com/user_upload_by_module/session_file/310419663030263150/PZGumcJnDdDnCtqE.jpg') center/cover no-repeat fixed;
            z-index: -1;
            opacity: 0.3;
        }

        /* ØªØ£Ø«ÙŠØ± Ø´Ø¨ÙƒØ© ØªÙ‚Ù†ÙŠØ© */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(90deg, rgba(0, 212, 255, 0.03) 1px, transparent 1px),
                linear-gradient(rgba(0, 212, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: -1;
            animation: grid-move 20s linear infinite;
        }

        @keyframes grid-move {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .container {
            background: var(--glass);
            border-radius: 24px;
            box-shadow: var(--shadow);
            max-width: 600px;
            width: 100%;
            padding: 40px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 212, 255, 0.2);
            animation: slideUp 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        /* ØªØ£Ø«ÙŠØ± ØªÙˆÙ‡Ø¬ */
        .container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0, 212, 255, 0.1) 0%, transparent 70%);
            animation: glow-pulse 4s ease-in-out infinite;
        }

        @keyframes glow-pulse {
            0%, 100% { opacity: 0.5; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
            position: relative;
            z-index: 1;
        }

        h1 { 
            color: var(--primary); 
            margin-bottom: 10px; 
            font-weight: 800; 
            font-size: 2rem;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
            letter-spacing: 1px;
        }

        .subtitle { 
            color: rgba(255, 255, 255, 0.7); 
            font-size: 1rem;
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±ÙØ¹ */
        .upload-area {
            border: 2px dashed rgba(0, 212, 255, 0.3);
            border-radius: 20px;
            padding: 50px 30px;
            text-align: center;
            background: var(--glass-light);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            z-index: 1;
        }

        .upload-area:hover {
            border-color: var(--primary);
            background: rgba(0, 212, 255, 0.05);
            box-shadow: var(--glow);
            transform: translateY(-2px);
        }

        .upload-area:active { transform: scale(0.98); }
        
        .upload-area.dragover { 
            border-color: var(--secondary); 
            background: rgba(168, 85, 247, 0.1); 
            transform: scale(1.02); 
            box-shadow: 0 0 40px rgba(168, 85, 247, 0.4);
        }
        
        .upload-icon { 
            font-size: 64px; 
            margin-bottom: 20px; 
            animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(0, 212, 255, 0.5));
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .upload-text { 
            color: var(--primary); 
            font-weight: 700; 
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .upload-hint { 
            color: rgba(255, 255, 255, 0.5); 
            font-size: 0.9rem;
        }

        /* Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        .input-group { 
            margin-top: 25px; 
            position: relative;
            z-index: 1;
        }

        .desc-input, .rename-input {
            width: 100%;
            padding: 16px;
            border: 2px solid rgba(0, 212, 255, 0.2);
            border-radius: 14px;
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s;
            background: var(--glass-light);
            color: #fff;
        }

        .desc-input::placeholder, .rename-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .desc-input:focus, .rename-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
            background: rgba(0, 212, 255, 0.05);
        }

        /* Ø®ÙŠØ§Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ³Ù…ÙŠØ© */
        .rename-option {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            padding: 15px;
            background: var(--glass-light);
            border-radius: 12px;
            border: 1px solid rgba(0, 212, 255, 0.1);
        }

        .rename-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        .rename-label {
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
            cursor: pointer;
            user-select: none;
        }

        .rename-input-wrapper {
            margin-top: 15px;
            display: none;
        }

        .rename-input-wrapper.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù„Ù */
        .file-info {
            margin-top: 20px;
            padding: 20px;
            background: rgba(0, 212, 255, 0.05);
            border-radius: 14px;
            border: 1px solid rgba(0, 212, 255, 0.2);
            display: none;
        }

        .file-info.active { 
            display: block; 
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .file-info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95rem;
        }

        .file-info-label { 
            color: var(--primary); 
            font-weight: 600;
        }

        /* Ø²Ø± Ø§Ù„Ø±ÙØ¹ */
        .upload-btn {
            width: 100%;
            padding: 18px;
            margin-top: 25px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: #fff;
            border: none;
            border-radius: 14px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .upload-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .upload-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .upload-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 212, 255, 0.5);
        }

        .upload-btn:active {
            transform: translateY(-1px);
        }

        .upload-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 212, 255, 0.1);
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
            display: none;
        }

        .progress-bar.active { 
            display: block; 
            animation: fadeIn 0.3s ease;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 10px;
            transition: width 0.3s;
            box-shadow: 0 0 10px var(--primary);
        }

        /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
        .message {
            margin-top: 20px;
            padding: 18px;
            border-radius: 14px;
            display: none;
            animation: slideDown 0.3s ease;
        }

        .message.active { display: block; }

        .message.success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #10b981;
        }

        .message.error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }

        .action-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Tajawal', sans-serif;
        }

        .btn-view {
            background: rgba(0, 212, 255, 0.1);
            color: var(--primary);
            border: 1px solid rgba(0, 212, 255, 0.3);
        }

        .btn-view:hover {
            background: rgba(0, 212, 255, 0.2);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
        }

        .btn-download {
            background: rgba(168, 85, 247, 0.1);
            color: var(--secondary);
            border: 1px solid rgba(168, 85, 247, 0.3);
        }

        .btn-download:hover {
            background: rgba(168, 85, 247, 0.2);
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
        }

        /* Ø²Ø± Ø§Ù„Ù…Ø¹Ø±Ø¶ */
        .gallery-link {
            display: block;
            text-align: center;
            margin-top: 25px;
            padding: 16px;
            background: var(--glass-light);
            border: 1px solid rgba(0, 212, 255, 0.2);
            border-radius: 14px;
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
        }

        .gallery-link:hover {
            background: rgba(0, 212, 255, 0.1);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
            transform: translateY(-2px);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 30px 25px;
                border-radius: 20px;
            }

            h1 { 
                font-size: 1.6rem; 
            }

            .subtitle { 
                font-size: 0.9rem; 
            }

            .upload-area { 
                padding: 40px 20px; 
            }

            .upload-icon { 
                font-size: 52px; 
            }

            .upload-text {
                font-size: 1rem;
            }

            .upload-hint {
                font-size: 0.85rem;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 15px;
            }

            .container {
                padding: 25px 20px;
                border-radius: 18px;
            }

            h1 { 
                font-size: 1.4rem; 
            }

            .subtitle { 
                font-size: 0.85rem; 
            }

            .upload-area { 
                padding: 35px 15px; 
            }

            .upload-icon { 
                font-size: 48px; 
            }

            .upload-text {
                font-size: 0.95rem;
            }

            .upload-hint {
                font-size: 0.8rem;
            }

            .desc-input, .rename-input {
                padding: 14px;
                font-size: 0.95rem;
            }

            .upload-btn {
                padding: 16px;
                font-size: 1rem;
            }

            .action-buttons {
                flex-direction: column;
            }

            .action-btn {
                padding: 12px;
                font-size: 0.95rem;
            }
        }

        @media (max-width: 360px) {
            .container {
                padding: 20px 15px;
            }

            h1 { 
                font-size: 1.3rem; 
            }

            .upload-area { 
                padding: 30px 12px; 
            }

            .upload-icon { 
                font-size: 42px; 
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„ÙˆØ­ÙŠØ© */
        @media (min-width: 768px) and (max-width: 1024px) {
            .container {
                max-width: 650px;
                padding: 45px;
            }

            h1 {
                font-size: 2.2rem;
            }

            .upload-area {
                padding: 55px 35px;
            }

            .upload-icon {
                font-size: 70px;
            }
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© */
        @media (min-width: 1200px) {
            .container {
                max-width: 700px;
                padding: 50px;
            }

            h1 {
                font-size: 2.4rem;
            }

            .upload-area {
                padding: 60px 40px;
            }

            .upload-icon {
                font-size: 76px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>â˜ï¸ MoTech Cloud</h1>
            <p class="subtitle">Ø±Ø§ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ø°ÙƒÙŠ - Ù…Ø¯Ø¹ÙˆÙ… Ø¨ØªÙ‚Ù†ÙŠØ© ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</p>
        </div>

        <form id="uploadForm" enctype="multipart/form-data">
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">ğŸ“¤</div>
                <div class="upload-text">Ø§Ø¶ØºØ· Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„Ù Ù‡Ù†Ø§</div>
                <div class="upload-hint">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰: 50 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª</div>
                <input type="file" id="fileInput" hidden>
            </div>

            <div class="file-info" id="fileInfo">
                <div class="file-info-item">
                    <span class="file-info-label">ğŸ“„ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</span>
                    <span id="fileName">-</span>
                </div>
                <div class="file-info-item">
                    <span class="file-info-label">ğŸ“Š Ø§Ù„Ø­Ø¬Ù…:</span>
                    <span id="fileSize">-</span>
                </div>
                <div class="file-info-item">
                    <span class="file-info-label">ğŸ“ Ø§Ù„Ù†ÙˆØ¹:</span>
                    <span id="fileType">-</span>
                </div>
            </div>

            <div class="input-group">
                <textarea 
                    id="descInput" 
                    class="desc-input" 
                    placeholder="ğŸ’¬ Ø£Ø¶Ù ÙˆØµÙØ§Ù‹ Ù„Ù„Ù…Ù„Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)..."
                    rows="3"
                ></textarea>
            </div>

            <div class="rename-option">
                <input type="checkbox" id="renameCheckbox" class="rename-checkbox">
                <label for="renameCheckbox" class="rename-label">âš™ï¸ Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ù…ÙŠØ© Ø§Ù„Ù…Ù„Ù</label>
            </div>

            <div class="rename-input-wrapper" id="renameWrapper">
                <input 
                    type="text" 
                    id="renameInput" 
                    class="rename-input" 
                    placeholder="âœï¸ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯..."
                >
            </div>

            <button type="submit" class="upload-btn" id="uploadBtn">
                ğŸš€ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù
            </button>

            <div class="progress-bar" id="progressBar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <div class="message" id="message"></div>

            <div class="action-buttons" id="actionButtons" style="display: none;">
                <button type="button" class="action-btn btn-view" id="viewBtn">
                    ğŸ‘ï¸ Ù…Ø´Ø§Ù‡Ø¯Ø©
                </button>
                <button type="button" class="action-btn btn-download" id="downloadBtn">
                    â¬‡ï¸ ØªØ­Ù…ÙŠÙ„
                </button>
            </div>
        </form>

        <a href="/gallery" class="gallery-link">
            ğŸ“‚ Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª
        </a>
    </div>

   <script>
        let selectedFile = null;

        // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¹Ù†Ø§ØµØ±
        const elements = {
            uploadArea: document.getElementById('uploadArea'),
            fileInput: document.getElementById('fileInput'),
            fileInfo: document.getElementById('fileInfo'),
            uploadForm: document.getElementById('uploadForm'),
            uploadBtn: document.getElementById('uploadBtn'),
            progressBar: document.getElementById('progressBar'),
            progressFill: document.getElementById('progressFill'),
            message: document.getElementById('message'),
            actionButtons: document.getElementById('actionButtons'),
            renameCheckbox: document.getElementById('renameCheckbox'),
            renameWrapper: document.getElementById('renameWrapper'),
            renameInput: document.getElementById('renameInput'),
            viewBtn: document.getElementById('viewBtn'),
            downloadBtn: document.getElementById('downloadBtn'),
            fileName: document.getElementById('fileName'),
            fileSize: document.getElementById('fileSize'),
            fileType: document.getElementById('fileType'),
            descInput: document.getElementById('descInput')
        };

        // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„Ù
        elements.uploadArea.addEventListener('click', () => elements.fileInput.click());

        // ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
        elements.uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            elements.uploadArea.classList.add('dragover');
        });

        elements.uploadArea.addEventListener('dragleave', () => {
            elements.uploadArea.classList.remove('dragover');
        });

        elements.uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            elements.uploadArea.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file) handleFileSelect(file);
        });

        // Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù
        elements.fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) handleFileSelect(file);
        });

        // Ø¯Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù
        function handleFileSelect(file) {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¬Ù… (50 Ù…ÙŠØ¬Ø§)
            if (file.size > 50 * 1024 * 1024) {
                showMessage('âŒ Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹! Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 50 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª', 'error');
                return;
            }

            selectedFile = file;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
            elements.fileName.textContent = file.name;
            elements.fileSize.textContent = formatBytes(file.size);
            elements.fileType.textContent = file.type || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
            
            elements.fileInfo.classList.add('active');
            elements.renameInput.value = file.name; // ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
            
            hideMessage();
            elements.actionButtons.style.display = 'none'; // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯
        }

        // Ù…Ù†Ø·Ù‚ Ù…Ø±Ø¨Ø¹ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ³Ù…ÙŠØ© (CheckBox)
        elements.renameCheckbox.addEventListener('change', () => {
            if (elements.renameCheckbox.checked) {
                elements.renameWrapper.style.display = 'block'; // Ø¥Ø¬Ø¨Ø§Ø± Ø§Ù„Ø¸Ù‡ÙˆØ±
                elements.renameWrapper.classList.add('active');
                elements.renameInput.focus();
            } else {
                elements.renameWrapper.style.display = 'none';
                elements.renameWrapper.classList.remove('active');
            }
        });

        // Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø±ÙØ¹
        elements.uploadForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            if (!selectedFile) {
                showMessage('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }

            const formData = new FormData();
            
            // Ù…Ù†Ø·Ù‚ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ³Ù…ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ø±ÙØ¹
            let fileToUpload = selectedFile;
            if (elements.renameCheckbox.checked && elements.renameInput.value.trim() !== '') {
                const newFileName = elements.renameInput.value.trim();
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
                fileToUpload = new File([selectedFile], newFileName, { type: selectedFile.type });
            }
            
            formData.append('file', fileToUpload);
            
            const description = elements.descInput.value.trim();
            if (description) {
                formData.append('description', description);
            }

            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø±ÙØ¹
            elements.uploadBtn.disabled = true;
            elements.uploadBtn.innerHTML = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...';
            elements.progressBar.classList.add('active');
            hideMessage();
            elements.actionButtons.style.display = 'none';

            try {
                const xhr = new XMLHttpRequest();

                // Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
                xhr.upload.addEventListener('progress', (e) => {
                    if (e.lengthComputable) {
                        const percent = (e.loaded / e.total) * 100;
                        elements.progressFill.style.width = percent + '%';
                    }
                });

                // Ø¹Ù†Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
                xhr.addEventListener('load', () => {
                    elements.uploadBtn.disabled = false;
                    elements.uploadBtn.innerHTML = 'ğŸš€ Ø±ÙØ¹ Ù…Ù„Ù Ø¢Ø®Ø±';
                    elements.progressBar.classList.remove('active');
                    elements.progressFill.style.width = '0%';

                    if (xhr.status === 200) {
                        try {
                            const result = JSON.parse(xhr.responseText);
                            
                            if (result.success) {
                                showMessage('âœ… ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                                elements.actionButtons.style.display = 'flex'; // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                                
                                // â˜…â˜…â˜… Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù‡Ù†Ø§ â˜…â˜…â˜…
                                // Ù†Ù‚ÙˆÙ… Ø¨Ø±Ø¨Ø· Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ø§Ø¯Ù… Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
                                const fileId = result.db_id; 
                                
                                // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©
                                elements.viewBtn.onclick = function() {
                                    window.open(`/view/${fileId}`, '_blank');
                                };

                                // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
                                elements.downloadBtn.onclick = function() {
                                    window.open(`/download/${fileId}`, '_blank');
                                };
                                
                                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                                resetForm(false); 

                            } else {
                                showMessage('âŒ ÙØ´Ù„ Ø§Ù„Ø±ÙØ¹: ' + (result.error || 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'), 'error');
                            }
                        } catch (e) {
                            console.error('JSON Error:', e);
                            showMessage('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø±Ø¯ Ø§Ù„Ø³ÙŠØ±ÙØ±', 'error');
                        }
                    } else {
                        showMessage('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±: ' + xhr.status, 'error');
                    }
                });

                xhr.addEventListener('error', () => {
                    showMessage('âŒ ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±', 'error');
                    resetUIState();
                });

                xhr.open('POST', '/upload');
                xhr.send(formData);

            } catch (error) {
                showMessage('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£: ' + error.message, 'error');
                resetUIState();
            }
        });

        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©
        function formatBytes(bytes) {
            if (bytes === 0) return '0 Ø¨Ø§ÙŠØª';
            const k = 1024;
            const sizes = ['Ø¨Ø§ÙŠØª', 'ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª', 'Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª', 'Ø¬ÙŠØ¬Ø§Ø¨Ø§ÙŠØª'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }

        function showMessage(text, type) {
            elements.message.textContent = text;
            elements.message.className = 'message ' + type + ' active';
        }

        function hideMessage() {
            elements.message.classList.remove('active');
        }

        function resetUIState() {
            elements.uploadBtn.disabled = false;
            elements.uploadBtn.innerHTML = 'ğŸš€ Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù';
            elements.progressBar.classList.remove('active');
        }

        function resetForm(clearFile = true) {
            if (clearFile) {
                selectedFile = null;
                elements.fileInput.value = '';
                elements.fileInfo.classList.remove('active');
            }
            // Ù„Ø§ Ù†Ù…Ø³Ø­ Ø§Ù„ÙˆØµÙ ÙˆØ§Ù„Ø§Ø³Ù… ÙÙˆØ±Ø§Ù‹ Ù„ÙƒÙŠ ÙŠØ±Ø§Ù‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ Ù„ÙƒÙ† Ù†Ø¬Ù‡Ø² Ù„Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯
            elements.renameCheckbox.checked = false;
            elements.renameWrapper.style.display = 'none';
        }
    </script>
</body>
</html>
